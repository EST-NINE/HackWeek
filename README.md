# HackWeek

# 接口说明
## 1.1：注册

- 请求路径：api/v1/user/register
- 请求方法：POST
- 请求体

|   参数    |           含义           |              备注              |
| :-------: | :----------------------: | :----------------------------: |
| user_name |         用户姓名         | 只能包含汉字、大小写字母、数字 |
| password  | 经前端加密过后的用户密码 |  经前端加密，后端存储时也加密  |

```
{
     "user_name":"lxy",
     "password":"123456"
}
```



- 响应体

|  参数  |         含义         | 备注 |
| :----: | :------------------: | ---- |
| status | 后端响应返回的状态码 |      |
|  data  |     数据或者信息     |      |
|  msg   |       响应信息       |      |
| error  |     详细错误信息     |      |

```
{
    "status": 200,
    "data": "操作成功",
    "msg": "操作成功",
    "error": ""
}
```



## 1.2：登录

- 请求路径：api/v1/user/login
- 请求方法：POST
- 请求体

|   参数    |   含义   |              备注              |
| :-------: | :------: | :----------------------------: |
| user_name | 用户姓名 | 只能包含汉字、大小写字母、数字 |
| password  | 用户密码 |  经前端加密，后端存储时也加密  |

```
{
     "user_name":"lxy",
     "password":"123456"
}
```



- 响应体

|    参数     |     含义     |     备注     |
| :---------: |:----------:| :----------: |
|   status    | 后端响应返回的状态码 |              |
|    data     |    用户数据    |              |
| data->user  |    用户信息    |              |
| data->token |  认证token   | 有效期为一天 |
|     msg     |    响应信息    |              |
|    error    |   详细错误信息   |              |

```
{
    "status": 200,
    "data": {
        "user": {
            "id": 2,
            "user_name": "lxy",
            "kitchen": "lxy的厨房",
            "create_at": 1701557314,
        },
        "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwidXNlcm5hbWUiOiJseHkiLCJleHAiOjE3MDE2NDM3MjUsImlzcyI6InRvLWRvLWxpc3QifQ.XOQFVHIcdttR0BpQFANUcbLmgstmZhQh5BM6hwm2Qek"
    },
    "msg": "操作成功",
    "error": ""
}
```

## 2.1：更改密码

- 请求路径：api/v1/user/updatePwd
- 请求方法：POST
- 请求体(需要token认证)

|    参数     | 含义  |         备注         |
|:---------:|:---:| :------------------: |
| updatePwd | 新密码 |  |

```
{
    "originPwd":"1234567",
    "updatePwd":"123456"
}
```



- 响应体

|  参数  |         含义         | 备注 |
| :----: | :------------------: | :--: |
| status | 后端响应返回的状态码 |      |
|  data  |     数据或者信息     |      |
|  msg   |       响应信息       |      |
| error  |     详细错误信息     |      |

```
{
    "status": 200,
    "data": "操作成功",
    "msg": "操作成功",
    "error": ""
}
```


## 2.2：更改用户个人信息

- 请求路径：api/v1/user/updateInfo
- 请求方法：POST
- 请求体(需要token认证)

|     参数      |   含义   |         备注         |
|:-----------:|:------:| :------------------: |
|   kitchen   | 用户厨房名字 |  |
| update_name | 用户名字信息 |  |

```
{
    "kitchen":"不知道叫什么名字的厨房",
    "update_name":"test566"
}
```



- 响应体

|  参数  |         含义         | 备注 |
| :----: | :------------------: | :--: |
| status | 后端响应返回的状态码 |      |
|  data  |     数据或者信息     |      |
|  msg   |       响应信息       |      |
| error  |     详细错误信息     |      |

```
{
    "status": 200,
    "data": "操作成功",
    "msg": "操作成功",
    "error": ""
}
```

## 2.3：得到登录用户的详细信息

- 请求路径：api/v1/user/info
- 请求方法：Get
- 请求体(需要token认证)：无


- 响应体

|  参数  |     含义     |    备注     |
| :----: |:----------:|:---------:|
| status | 后端响应返回的状态码 |           |
|  data  |   登录用户数据   | 后续可能会添加信息 |
|  msg   |    响应信息    |           |
| error  |   详细错误信息   |           |

```
{
    "status": 200,
    "data": {
        "id": 37,
        "user_name": "test566",
        "kitchen": "不知道叫什么名字的厨房",
        "create_at": 1701956362
    },
    "msg": "操作成功",
    "error": ""
}
```

## 3.1：获取星火大模型V3.0生成的故事
- 请求路径：api/v1/story/generateStory
- 请求方法：Post
- 请求体(需要token认证)

|  参数  |     含义     |    备注     |
| :----: |:----------:|:---------:|
| mood| 故事的心情 | |
| keywords| 故事的关键词 | 关键词之间用+连接 |
```
{
    "mood" : "开心",
    "keywords":"室友+电脑"
}
```
- 响应体

|  参数  |     含义     |    备注     |
| :----: |:----------:|:---------:|
| status | 后端响应返回的状态码 |           |
|  data  |   故事的内容    |  |
|  msg   |    响应信息    |           |
| error  |   详细错误信息   |           ||
```
{
    "status": 200,
    "data": "有一天，室友突然对我说：“我发现一个超级好玩的游戏！我们来一起玩吧！”我好奇地问：“是什么游戏？”他神秘地笑了笑，拿出了他的电脑。原来，这个游戏就是他自己编写的，名字叫“开心果”。我疑惑地看着他：“开心果？这听起来不太正常。”他得意地说：“你试试看就知道了！”于是，我坐在他的电脑前，开始玩起了这个游戏。结果，我发现这个游戏居然是一个模拟人生的场景，我需要扮演一个非常搞笑的角色，完成各种奇怪的任务。我和室友玩得不亦乐乎，笑声不断。最后，我忍不住问他：“你是怎么想到这么搞怪的游戏的？”他笑着说：“因为我是个开心果啊！”",
    "msg": "操作成功",
    "error": ""
}
```
## 3.2：数据库中创建对应用户的故事
- 请求路径：api/v1/story/createStory
- 请求方法：Post
- 请求体(需要token认证)

|  参数  |     含义     |    备注     |
| :----: |:----------:|:---------:|
| mood| 故事的心情 | |
| keywords| 故事的关键词 | 关键词之间用+连接 |
```
{
    "title":"story3",
    "mood" : "开心",
    "keywords":"室友+电脑",
    "content":"有一天，室友突然对我说：“我发现一个超级好玩的游戏！我们来一起玩吧！”我好奇地问：“是什么游戏？”他神秘地笑了笑，拿出了他的电脑。原来，这个游戏就是他自己编写的，名字叫“开心果”。我疑惑地看着他：“开心果？这听起来不太正常。”他得意地说：“你试试看就知道了！”于是，我坐在他的电脑前，开始玩起了这个游戏。结果，我发现这个游戏居然是一个模拟人生的场景，我需要扮演一个非常搞笑的角色，完成各种奇怪的任务。我和室友玩得不亦乐乎，笑声不断。最后，我忍不住问他：“你是怎么想到这么搞怪的游戏的？”他笑着说：“因为我是个开心果啊！”"
}
```
- 响应体

|  参数  |         含义         | 备注 |
| :----: | :------------------: | :--: |
| status | 后端响应返回的状态码 |      |
|  data  |     数据或者信息     |      |
|  msg   |       响应信息       |      |
| error  |     详细错误信息     |      |
```
{
    "status": 200,
    "data": "操作成功",
    "msg": "操作成功",
    "error": ""
}
```

## 3.3：得到对应用户的故事列表
- 请求路径：api/v1/story/listStory
- 请求方法：Post
- 请求体(需要token认证)

|  参数  |     含义     |    备注     |
| :----: |:----------:|:---------:|
| page| 查询开始页数 | |
| limit | 每页要查询的个数 | 默认是15 |
```
{
    "page":1,
    "limit":10
}
```
- 响应体

| 参数        | 含义                 | 备注     |
| ----------- | -------------------- | -------- |
| status      | 后端响应返回的状态码 |          |
| data        | 数据                 |          |
| data->item  | 该用户的故事列表     | 数组类型 |
| data->total | 故事列表的个数       |          |
| msg         | 响应信息             |          |
| error       | 详细错误信息         |          |



```
{
    "status": 200,
    "data": {
        "item": [
            {
                "id": 1,
                "title": "story1",
                "mood": "开心",
                "keywords": "室友+电脑",
                "content": "有一天，室友突然对我说：“我发现一个超级好玩的游戏！我们来一起玩吧！”我好奇地问：“是什么游戏？”他神秘地笑了笑，拿出了他的电脑。原来，这个游戏就是他自己编写的，名字叫“开心果”。我疑惑地看着他：“开心果？这听起来不太正常。”他得意地说：“你试试看就知道了！”于是，我坐在他的电脑前，开始玩起了这个游戏。结果，我发现这个游戏居然是一个模拟人生的场景，我需要扮演一个非常搞笑的角色，完成各种奇怪的任务。我和室友玩得不亦乐乎，笑声不断。最后，我忍不住问他：“你是怎么想到这么搞怪的游戏的？”他笑着说：“因为我是个开心果啊！”",
                "created_at": "2023-12-07 04:53:30"
            },
            {
                "id": 4,
                "title": "story4",
                "mood": "开心",
                "keywords": "室友+电脑",
                "content": "有一天，室友突然对我说：“我发现一个超级好玩的游戏！我们来一起玩吧！”我好奇地问：“是什么游戏？”他神秘地笑了笑，拿出了他的电脑。原来，这个游戏就是他自己编写的，名字叫“开心果”。我疑惑地看着他：“开心果？这听起来不太正常。”他得意地说：“你试试看就知道了！”于是，我坐在他的电脑前，开始玩起了这个游戏。结果，我发现这个游戏居然是一个模拟人生的场景，我需要扮演一个非常搞笑的角色，完成各种奇怪的任务。我和室友玩得不亦乐乎，笑声不断。最后，我忍不住问他：“你是怎么想到这么搞怪的游戏的？”他笑着说：“因为我是个开心果啊！”",
                "created_at": "2023-12-07 05:05:32"
            }
        ],
        "total": 2
    },
    "msg": "查询列表成功",
    "error": ""
}
```
## 3.4：删除对应故事的历史记录
- 请求路径：api/v1/story/deleteStory
- 请求方法：Post
- 请求体(需要token认证)

|  参数   |     含义     | 备注 |
|:-----:|:----------:| :--: |
| title | 对应故事的title |      |



```
{
    "title":"story777"
}
```
- 响应体

|  参数  |         含义         | 备注 |
| :----: | :------------------: | :--: |
| status | 后端响应返回的状态码 |      |
|  data  |     数据或者信息     |      |
|  msg   |       响应信息       |      |
| error  |     详细错误信息     |      |
```
{
    "status": 200,
    "data": "操作成功",
    "msg": "操作成功",
    "error": ""
}
```
## 3.5：修改历史记录
- 请求路径：api/v1/story/updateStory
- 请求方法：Post
- 请求体(需要token认证)

|      参数      |      含义      |    备注     |
|:------------:|:------------:|:---------:|
|    title     |   故事的title   | |
| update_title |  需要修改的tilte  | 可不填 |
|   update_content    | 需要修改的content | 可不填 |
```
{
    "title":"story777",
    "update_title":"更新了哦",
    "update_content":"我才没有"
}
```
- 响应体

|  参数  |         含义         | 备注 |
| :----: | :------------------: | :--: |
| status | 后端响应返回的状态码 |      |
|  data  |     Story的数据      |      |
|  msg   |       响应信息       |      |
| error  |     详细错误信息     |      |



```
{
    "status": 200,
    "data": {
        "id": 1,
        "title": "更新了哦",
        "mood": "开心",
        "keywords": "室友+电脑",
        "content": "我才没有",
        "created_at": "2023-12-07 04:53:30"
    },
    "msg": "操作成功",
    "error": ""
}
```
## 3.6：根据mood分类查找历史记录
- 请求路径：api/v1/story/selectStory
- 请求方法：Post
- 请求体(需要token认证)

| 参数 | 含义 |              备注               |
| :--: | :--: | :-----------------------------: |
| mood | 情绪 | 找到对应用户下的这个情绪的story |



```
{
    "mood":"难过"
}
```
- 响应体

|    参数     |         含义         |   备注   |
| :---------: | :------------------: | :------: |
|   status    | 后端响应返回的状态码 |          |
|    data     |         数据         |          |
| data->item  |   该用户的故事列表   | 数组类型 |
| data->total |    故事列表的个数    |          |
|     msg     |       响应信息       |          |
|    error    |     详细错误信息     |          |

```
{
    "status": 200,
    "data": {
        "item": [
            {
                "id": 8,
                "title": "story9",
                "mood": "难过",
                "keywords": "室友+电脑",
                "content": "有一天，室友突然对我说：“我发现一个超级好玩的游戏！我们来一起玩吧！”我好奇地问：“是什么游戏？”他神秘地笑了笑，拿出了他的电脑。原来，这个游戏就是他自己编写的，名字叫“开心果”。我疑惑地看着他：“开心果？这听起来不太正常。”他得意地说：“你试试看就知道了！”于是，我坐在他的电脑前，开始玩起了这个游戏。结果，我发现这个游戏居然是一个模拟人生的场景，我需要扮演一个非常搞笑的角色，完成各种奇怪的任务。我和室友玩得不亦乐乎，笑声不断。最后，我忍不住问他：“你是怎么想到这么搞怪的游戏的？”他笑着说：“因为我是个开心果啊！”",
                "created_at": "2023-12-07 08:36:19"
            },
            {
                "id": 9,
                "title": "story7",
                "mood": "难过",
                "keywords": "室友+电脑",
                "content": "有一天，室友突然对我说：“我发现一个超级好玩的游戏！我们来一起玩吧！”我好奇地问：“是什么游戏？”他神秘地笑了笑，拿出了他的电脑。原来，这个游戏就是他自己编写的，名字叫“开心果”。我疑惑地看着他：“开心果？这听起来不太正常。”他得意地说：“你试试看就知道了！”于是，我坐在他的电脑前，开始玩起了这个游戏。结果，我发现这个游戏居然是一个模拟人生的场景，我需要扮演一个非常搞笑的角色，完成各种奇怪的任务。我和室友玩得不亦乐乎，笑声不断。最后，我忍不住问他：“你是怎么想到这么搞怪的游戏的？”他笑着说：“因为我是个开心果啊！”",
                "created_at": "2023-12-07 08:36:26"
            }
        ],
        "total": 2
    },
    "msg": "查询列表成功",
    "error": ""
}
```
## 4-1：触发彩蛋操作
- 请求路径：api/v1/menu/isMenu
- 请求方法：Post
- 请求体(需要token认证)

|      参数      |      含义      |    备注     |
|:------------:|:------------:|:---------:|
| keywords |   触发彩蛋的关键词   | 目前顺序为固定的,后续考虑修改 |
```
{
    "keywords":"室友+电脑+试卷"
}
```
- 响应体

|  参数  |         含义         | 备注 |
| :----: | :------------------: | :--: |
| status | 后端响应返回的状态码 |      |
|  data  |      menu的数据      |      |
|  msg   |       响应信息       |      |
| error  |     详细错误信息     |      |



```
{
    "status": 200,
    "data": {
        "id": 1,
        "keywords": "室友+电脑+试卷",
        "content": "恭喜你，触发了第一个彩蛋哦！"
    },
    "msg": "操作成功",
    "error": ""
}
```